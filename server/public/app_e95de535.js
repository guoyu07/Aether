webpackJsonp([0,2],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){f["default"].getState().getIn(["user","username"])?n():f["default"].dispatch((0,w["default"])(e,t,n))}var a=n(1),u=r(a),i=n(30),s=n(163),l=n(186),c=n(247),f=r(c),d=n(311),p=r(d),y=n(312),h=r(y),m=n(356),_=r(m),v=n(361),b=r(v);n(!function(){var e=new Error('Cannot find module "./base.css"');throw e.code="MODULE_NOT_FOUND",e}());var g=n(355),w=r(g);(0,i.render)(u["default"].createElement(s.Provider,{store:f["default"]},u["default"].createElement(l.Router,{history:l.browserHistory},u["default"].createElement(l.Route,{path:"/",component:p["default"]},u["default"].createElement(l.IndexRoute,{component:h["default"],onEnter:o}),u["default"].createElement(l.Route,{path:"login",component:_["default"]}),u["default"].createElement(l.Route,{path:"signup",component:b["default"]})))),document.getElementById("app"))},247:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(170),a=n(248),u=r(a),i=n(249),s=n(250),l=r(s),c=n(260),f=r(c),d=(0,i.fromJS)({currentGroup:"main",showSidebar:window.innerWidth>1024}),p=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose;t["default"]=(0,o.createStore)(l["default"],d,p((0,o.applyMiddleware)(u["default"].withExtraArgument(f["default"]))))},250:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(251),a=n(257),u=r(a),i=n(258),s=r(i),l=n(259),c=r(l);t["default"]=(0,o.combineReducers)({user:s["default"],groups:u["default"],currentGroup:function(e){return e},showSidebar:c["default"]})},257:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t["default"]=function(){var e=arguments.length<=0||void 0===arguments[0]?(0,a.fromJS)({}):arguments[0],t=arguments[1];switch(t.type){case"ADD_MESSAGE":var n=function(){var n=t.payload,r=n.timestamp,o=n.username,u=n.groupName,i=n.type,s=n.content,l={timestamp:r,username:o,content:s,type:i};return{v:e.map(function(e){return e.get("groupName")===u?e.update("messages",(0,a.fromJS)([]),function(e){return e.push((0,a.fromJS)(l))}):e})}}();if("object"===("undefined"==typeof n?"undefined":o(n)))return n.v;case"INITIALIZE_GROUP_INFO":return(0,a.fromJS)(t.payload);case"GETTING_HISTORY_MESSAGES":var u=function(){var n=t.payload;return{v:e.map(function(e){return e.get("groupName")===n?e.set("getting",!0):e})}}();if("object"===("undefined"==typeof u?"undefined":o(u)))return u.v;case"RECEIVE_HISTORY_MESSAGES":var i=function(){var n=t.payload,o=n.groupName,u=n.messages;return{v:e.map(function(e){return e.get("groupName")===o?e.update("messages",function(e){return e.unshift.apply(e,r((0,a.fromJS)(u)))}).set("getting",!1):e})}}();if("object"===("undefined"==typeof i?"undefined":o(i)))return i.v;default:return e}};var a=n(249)},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){var e=arguments.length<=0||void 0===arguments[0]?(0,r.fromJS)({username:void 0}):arguments[0],t=arguments[1];switch(t.type){case"INIT_USER_INFO":var n=t.payload;return n?(0,r.fromJS)(n):(0,r.fromJS)({username:void 0});default:return e}};var r=n(249)},259:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){switch(t.type){case"SWITCH_SIDEBAR":return!e;default:return e}}},260:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(261),a=r(o),u=(0,a["default"])();t["default"]=u},311:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t={width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"Helvetica Neue, Helvetica, Hiragino Sans GB, Microsoft YaHei, 微软雅黑, Arial, sans-serif"};return u["default"].createElement("div",{style:t},e.children)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(1),u=r(a);o.propTypes={children:a.PropTypes.element.isRequired}},312:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return{showSidebar:e.get("showSidebar")}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(163),u=n(313),i=r(u),s=n(354),l=r(s),c={initializeAndListening:l["default"]};t["default"]=(0,a.connect)(o,c)(i["default"])},313:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(314),f=r(c),d=n(326),p=r(d),y=n(333),h=r(y),m=n(338),_=r(m),v=n(346),b=r(v),g=n(352),w=r(g),E=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),i(t,[{key:"componentDidMount",value:function(){this.rightBox.style.flexBasis=this.rightBox.clientWidth+"px",this.props.initializeAndListening()}},{key:"render",value:function(){var e=this;return l["default"].createElement("div",{className:w["default"].app},l["default"].createElement("div",{className:w["default"].sidebar,style:{marginLeft:this.props.showSidebar?0:"-280px"}},l["default"].createElement(f["default"],null),l["default"].createElement(p["default"],null)),l["default"].createElement("div",{className:w["default"]["right-box"],ref:function(t){e.rightBox=t}},l["default"].createElement(h["default"],null),l["default"].createElement(_["default"],null),l["default"].createElement(b["default"],null)))}}]),t}(s.Component);t["default"]=E,E.propTypes={initializeAndListening:s.PropTypes.func.isRequired,showSidebar:s.PropTypes.bool.isRequired}},314:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return{username:e.getIn(["user","username"])}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(163),u=n(315),i=r(u);t["default"]=(0,a.connect)(o)(i["default"])},315:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(316),f=r(c),d=n(320),p=r(d),y=n(!function(){var e=new Error('Cannot find module "../../Utils"');throw e.code="MODULE_NOT_FOUND",e}()),h=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayDetail:!1,displayPanel:!1},n.handleDisplayPanel=n.handleDisplayPanel.bind(n),n.handleDisplayDetail=n.handleDisplayDetail.bind(n),n}return u(t,e),i(t,[{key:"handleDisplayDetail",value:function(){this.setState({displayDetail:!this.state.displayDetail})}},{key:"handleDisplayPanel",value:function(){this.state.displayPanel?this.setState({displayPanel:!1}):this.setState({panelTop:(0,y.getElementTop)(this.ele)+58,panelLeft:(0,y.getElementLeft)(this.ele)+80,displayPanel:!0})}},{key:"render",value:function(){var e=this;return l["default"].createElement("div",{className:f["default"].card,ref:function(t){e.ele=t}},l["default"].createElement("button",{onClick:this.handleDisplayDetail,className:f["default"].wrap},l["default"].createElement("img",{src:"",alt:"头像",className:f["default"].portrait})),l["default"].createElement("span",{className:f["default"]["user-name"]},this.props.username),l["default"].createElement("button",{className:f["default"].config,onClick:this.handleDisplayPanel},l["default"].createElement("i",{className:"iconfont icon-down "+f["default"].icon})),this.state.displayPanel?l["default"].createElement(p["default"],{handleDisplayPanel:this.handleDisplayPanel,location:{top:this.state.panelTop,left:this.state.panelLeft}}):null)}}]),t}(s.Component);t["default"]=h,h.propTypes={username:s.PropTypes.string.isRequired}},316:function(e,t){e.exports={card:"Dl7dC",wrap:"l9i3W",portrait:"sNTSJ","user-name":"spZdA",config:"yTlm4",icon:"_44rBE"}},320:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),a=n(321),u=r(a),i=n(324),s=r(i),l={logout:s["default"]};t["default"]=(0,o.connect)(null,l)(u["default"])},321:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(322),f=r(c),d=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.logout=n.logout.bind(n),n}return u(t,e),i(t,[{key:"logout",value:function(){this.props.logout()}},{key:"render",value:function(){var e=void 0,t=void 0;this.props.allowNotification?(e="关闭桌面通知",t="icon-info-on"):(e="开启桌面通知",t="icon-info-off");var n=void 0,r=void 0;return this.props.allowSound?(n="关闭声音",r="icon-sound-on"):(n="开启声音",r="icon-sound-off"),l["default"].createElement("div",{className:f["default"].mask,onClick:this.props.handleDisplayPanel},l["default"].createElement("ul",{className:f["default"].panel,style:this.props.location},l["default"].createElement("li",null,l["default"].createElement("button",{className:""+f["default"].option,onClick:this.props.launchChat},l["default"].createElement("i",{className:"iconfont icon-group "+f["default"].icon}),"发起聊天")),l["default"].createElement("li",null,l["default"].createElement("button",{className:""+f["default"].option,onClick:this.props.switchNotification},l["default"].createElement("i",{className:"iconfont "+t+" "+f["default"].icon}),e)),l["default"].createElement("li",null,l["default"].createElement("button",{className:""+f["default"].option,onClick:this.props.switchSound},l["default"].createElement("i",{className:"iconfont "+r+" "+f["default"].icon}),n)),l["default"].createElement("li",null,l["default"].createElement("a",{className:""+f["default"].option,href:"https://github.com/oddTick/Aether",target:"_blank",rel:"noopener noreferrer"},l["default"].createElement("i",{className:"iconfont icon-github "+f["default"].icon}),"源码")),l["default"].createElement("li",null,l["default"].createElement("button",{className:""+f["default"].option,onClick:this.logout},l["default"].createElement("i",{className:"iconfont icon-quit "+f["default"].icon}),"退出"))))}}]),t}(s.Component);t["default"]=d,d.propTypes={allowNotification:s.PropTypes.bool.isRequired,allowSound:s.PropTypes.bool.isRequired,handleDisplayPanel:s.PropTypes.func.isRequired,location:s.PropTypes.shape({top:s.PropTypes.number.isRequired,left:s.PropTypes.number.isRequired}),launchChat:s.PropTypes.func.isRequired,switchNotification:s.PropTypes.func.isRequired,switchSound:s.PropTypes.func.isRequired,logout:s.PropTypes.func.isRequired}},322:function(e,t){e.exports={mask:"TTynV",panel:"_1Y6Ng",option:"_1x5Xq",icon:"_1U22M"}},324:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){return function(e,t,n){n.emit("logout",localStorage.getItem("token")),localStorage.removeItem("token"),a.browserHistory.push("/login"),e((0,i["default"])())}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(186),u=n(325),i=r(u)},325:function(e,t){"use strict";function n(e){return{type:"INIT_USER_INFO",payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},326:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return{groups:e.get("groups")||[],currentGroup:e.get("currentGroup")}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(163),u=n(327),i=r(u);t["default"]=(0,a.connect)(o)(i["default"])},327:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=[];return e.groups.forEach(function(n){var r=n.get("groupName");t.push(u["default"].createElement(c["default"],{key:r,groupName:r,avatar:n.get("avatar"),isSelected:e.currentGroup===r}))}),u["default"].createElement("div",{style:f},t)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(1),u=r(a),i=n(249),s=r(i),l=n(328),c=r(l),f={flexGrow:1,overflow:"none"};o.propTypes={groups:a.PropTypes.instanceOf(s["default"].List),currentGroup:a.PropTypes.string.isRequired}},328:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),a=n(329),u=r(a),i=n(332),s=r(i),l={switchCurrentGroup:s["default"]};t["default"]=(0,o.connect)(null,l)(u["default"])},329:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(330),f=r(c),d=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return u(t,e),i(t,[{key:"handleClick",value:function(){this.props.switchCurrentGroup(this.props.groupName)}},{key:"render",value:function(){return l["default"].createElement("div",{className:f["default"].wrap,onClick:this.handleClick,style:{backgroundColor:this.props.isSelected?"#3A3F45":""}},l["default"].createElement("img",{src:this.props.avatar,alt:"",className:f["default"]["group-avatar"]}),l["default"].createElement("p",{className:f["default"]["group-name"]},this.props.groupName))}}]),t}(s.Component);t["default"]=d,d.propTypes={avatar:s.PropTypes.string.isRequired,groupName:s.PropTypes.string.isRequired,isSelected:s.PropTypes.bool.isRequired,switchCurrentGroup:s.PropTypes.func.isRequired}},330:function(e,t){e.exports={wrap:"rkx4h","group-avatar":"CjNsZ","group-name":"_29TZg"}},332:function(e,t){"use strict";function n(e){return{type:"SWITCH_CURRENT_GROUP",payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},333:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return{showSidebar:e.get("showSidebar"),name:e.get("currentGroup"),count:"1"}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(163),u=n(334),i=r(u),s=n(337),l=r(s),c={switchSidebar:l["default"]};t["default"]=(0,a.connect)(o,c)(i["default"])},334:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return u["default"].createElement("div",{className:s["default"].header},u["default"].createElement("button",{className:s["default"].switchButton,onClick:e.switchSidebar},u["default"].createElement("i",{className:"iconfont icon-switch "+s["default"].icon,style:{transform:e.showSidebar?"rotate(-45deg)":""}})),u["default"].createElement("div",{className:s["default"].title},e.name," (",e.count,")"))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(1),u=r(a),i=n(335),s=r(i);o.propTypes={showSidebar:a.PropTypes.bool.isRequired,switchSidebar:a.PropTypes.func.isRequired,name:a.PropTypes.string.isRequired,count:a.PropTypes.string.isRequired}},335:function(e,t){e.exports={header:"_3jTHL",switchButton:"_3AkdN",icon:"_22prL",title:"_3q6zC"}},337:function(e,t){"use strict";function n(){return{type:"SWITCH_SIDEBAR"}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},338:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e.get("currentGroup"),n=void 0;return e.get("groups").forEach(function(e){e.get("groupName")===t&&(n=e)}),{messages:n?n.get("messages"):void 0,username:e.getIn(["user","username"]),getting:!!n&&n.get("getting")}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(163),u=n(339),i=r(u),s=n(345),l=r(s),c={getHistoryMessages:l["default"]};t["default"]=(0,a.connect)(o,c)(i["default"])},339:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(249),f=r(c),d=n(340),p=r(d),y=n(343),h=r(y),m=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sate={scrollBottom:0},n.handleScroll=n.handleScroll.bind(n),n.handleResize=n.handleResize.bind(n),n}return u(t,e),i(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentWillReceiveProps",value:function(e){var t=this.ele,n=t.scrollHeight-t.clientHeight-t.scrollTop;0===n||this.props.getting&&!e.getting?this.setState({scrollBottom:n}):this.setState({scrollBottom:-1})}},{key:"componentDidUpdate",value:function(){this.state.scrollBottom!==-1&&this.setScrollBottom()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"setScrollBottom",value:function(){var e=this.ele,t=parseInt(e.scrollHeight-e.clientHeight-this.state.scrollBottom,10);e.scrollTop=t}},{key:"handleScroll",value:function(){var e=this.ele,t=e.scrollTop;0!==t||this.props.getting||this.props.getHistoryMessages()}},{key:"handleResize",value:function(){var e=this.ele;e.scrollTop=parseInt(e.scrollHeight-e.clientHeight,10)}},{key:"render",value:function(){var e=this,t=this.props.messages?this.props.messages.toJS():[];return t=t.map(function(t){return l["default"].createElement(p["default"],{key:t.username+t.timestamp,avatar:t.avatar,username:t.username,date:new Date(t.timestamp).toString().match(/([0-9]{2}:){2}[0-9]{2}/)[0],content:t.content,isMine:e.props.username===t.username})}),l["default"].createElement("div",{className:h["default"].wrap,ref:function(t){e.ele=t},onScroll:this.handleScroll},l["default"].createElement("i",{style:{display:this.props.getting?"block":"none"},className:h["default"].loading+" iconfont icon-loading"}),t)}}]),t}(s.PureComponent);t["default"]=m,m.propTypes={messages:s.PropTypes.instanceOf(f["default"].List).isRequired,username:s.PropTypes.string.isRequired,getHistoryMessages:s.PropTypes.func.isRequired,getting:s.PropTypes.bool.isRequired}},340:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(341),f=r(c),d=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showUserInfo:!1},n.switchUserInfo=n.switchUserInfo.bind(n),n}return u(t,e),i(t,[{key:"componentDidMount",value:function(){this.ele.style.maxWidth=this.ele.clientWidth+"px"}},{key:"switchUserInfo",value:function(){this.setState({showUserInfo:!this.state.showUserInfo})}},{key:"render",value:function(){var e=this,t=this.props,n=t.avatar,r=t.username,o=t.date,a=t.content,u=t.isMine;return l["default"].createElement("div",{className:f["default"].message,style:{direction:u?"rtl":"ltr"}},l["default"].createElement("img",{src:n,alt:"头像",className:f["default"].avatar,onClick:this.switchUserInfo}),l["default"].createElement("div",{className:f["default"].wrap,ref:function(t){e.ele=t}},l["default"].createElement("div",{className:f["default"].info},r," ",l["default"].createElement("date",null,o)),l["default"].createElement("p",{className:f["default"].content},a)))}}]),t}(s.Component);t["default"]=d,d.propTypes={avatar:s.PropTypes.string.isRequired,username:s.PropTypes.string.isRequired,date:s.PropTypes.string.isRequired,content:s.PropTypes.string.isRequired,isMine:s.PropTypes.bool.isRequired}},341:function(e,t){e.exports={message:"_1kV88",avatar:"_1EH0d",wrap:"Q_6SO",info:"_2rFQ2",content:"_1IdoE"}},343:function(e,t){e.exports={wrap:"_3OXbp",loading:"nu7oR",spin:"_3kCPm"}},345:function(e,t){"use strict";function n(){return function(e,t,n){var r=t(),o=r.get("currentGroup"),a=void 0;r.get("groups").forEach(function(e){e.get("groupName")===o&&(a=e.get("messages").size)}),e({type:"GETTING_HISTORY_MESSAGES",payload:o}),n.emit("getHistoryMessages",{groupName:o,before:a},function(t){e({type:"RECEIVE_HISTORY_MESSAGES",payload:{groupName:o,messages:t.success?t.messages:[]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},346:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),a=n(347),u=r(a),i=n(350),s=r(i),l={sendMessage:s["default"]};t["default"]=(0,o.connect)(null,l)(u["default"])},347:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(348),f=r(c),d=n(!function(){var e=new Error('Cannot find module "../../Utils"');throw e.code="MODULE_NOT_FOUND",e}()),p=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={content:"",showExpressions:!1},n.handleChange=n.handleChange.bind(n),n.switchExpressions=n.switchExpressions.bind(n),n.handleKeydown=n.handleKeydown.bind(n),n.selectExpression=n.selectExpression.bind(n),n.sendText=n.sendText.bind(n),n}return u(t,e),i(t,[{key:"handleKeydown",value:function(e){this.state.content&&"Enter"===e.key&&this.sendText()}},{key:"handleChange",value:function(e){this.setState({content:e.target.value})}},{key:"switchExpressions",value:function(){this.setState({showExpressions:!this.state.showExpressions})}},{key:"selectExpression",value:function(e){this.setState({content:this.state.content+"#("+e.target.name+")"})}},{key:"sendText",value:function(){this.props.sendMessage({timestamp:Date.now(),type:"text",content:this.state.content.trim()}),this.setState({content:""}),this.input.focus()}},{key:"render",value:function(){var e=this,t=void 0;t=this.state.content?l["default"].createElement("input",{type:"button",className:f["default"]["send-text"],onClick:this.sendText,value:"发送"}):l["default"].createElement("label",{htmlFor:"file",className:f["default"]["send-img"],onClick:this.sendImg},l["default"].createElement("input",{id:"file",type:"file",style:{display:"none"}}),l["default"].createElement("i",{className:"iconfont icon-img "+f["default"].icon}));var n=d.expressions.map(function(t,n){return l["default"].createElement("i",{style:{backgroundPosition:"0 "+30*-n+"px"},"data-item":t,onClick:e.switchExpressions})});return l["default"].createElement("div",{className:f["default"].wrap},l["default"].createElement("input",{type:"text",className:f["default"].input,value:this.state.content,onChange:this.handleChange,onKeyDown:this.handleKeydown,ref:function(t){e.input=t}}),l["default"].createElement("button",{className:f["default"]["switch-expressions"],onClick:this.switchExpressions},l["default"].createElement("i",{className:"iconfont icon-expression "+f["default"].icon})),this.state.showExpressions&&l["default"].createElement("div",{className:f["default"].expressions},n),t)}}]),t}(s.Component);t["default"]=p,p.propTypes={sendMessage:s.PropTypes.func.isRequired}},348:function(e,t){e.exports={wrap:"_3RwL1",input:"_1o0Tk","switch-expressions":"_2pl8y","send-text":"_3NaXZ","send-img":"_3Wdof",icon:"_1K4Et",expressions:"_3N7UP"}},350:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(t,n,r){var o=n();e.groupName=o.get("currentGroup"),r.emit("message",e),e.username=o.getIn(["user","username"]),t((0,u["default"])(e))}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(351),u=r(a)},351:function(e,t){"use strict";function n(e){return{type:"ADD_MESSAGE",payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},352:function(e,t){e.exports={app:"WDedh",sidebar:"_2mKjC","right-box":"_1K_9M"}},354:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){return function(e,t,n){var r=t().getIn(["user","groups"]).toJS();n.emit("getGroupsInfo",{groupsName:r},function(t){e({type:"INITIALIZE_GROUP_INFO",payload:t}),n.on("message",function(t){e((0,u["default"])(t))}),n.on("reconnect",function(){e((0,s["default"])())})})}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(351),u=r(a),i=n(355),s=r(i)},355:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=arguments.length<=1||void 0===arguments[1]?a.browserHistory.push:arguments[1],n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2];return function(e,r,o){var a=localStorage.getItem("token");a?o.emit("loginWithToken",a,function(r){r.success?(e((0,i["default"])(r.user)),n()):(localStorage.removeItem("token"),t("/login"),n())}):(t("/login"),n())}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(186),u=n(325),i=r(u)},356:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),a=n(357),u=r(a),i=n(360),s=r(i),l={login:s["default"]};t["default"]=(0,o.connect)(null,l)(u["default"])},357:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(186),f=n(358),d=r(f),p=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={username:"",password:""},n.handleUsername=n.handleUsername.bind(n),n.handlePassword=n.handlePassword.bind(n),n.handleLogin=n.handleLogin.bind(n),n}return u(t,e),i(t,[{key:"handleUsername",value:function(e){this.setState({username:e.target.value.toString()})}},{key:"handlePassword",value:function(e){this.setState({password:e.target.value.toString()})}},{key:"handleLogin",value:function(){var e=this.state,t=e.username,n=e.password;t.trim(),n.trim(),this.props.login({
username:t,password:n})}},{key:"render",value:function(){return l["default"].createElement("div",{className:d["default"].wrap},l["default"].createElement("input",{type:"text",className:d["default"].input,placeholder:"请输入用户名",onChange:this.handleUsername,value:this.state.username}),l["default"].createElement("input",{type:"text",className:d["default"].input,placeholder:"请输入密码",onChange:this.handlePassword,value:this.state.password}),l["default"].createElement("input",{type:"button",className:d["default"].input,value:"登录",onClick:this.handleLogin}),l["default"].createElement(c.Link,{className:"",to:"/signup"},"没有账号？立即注册"))}}]),t}(s.Component);t["default"]=p,p.propTypes={login:s.PropTypes.func.isRequired}},358:function(e,t){e.exports={wrap:"DaRtN",input:"_2zvaj"}},360:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e.username,n=e.password;return function(e,r,o){o.emit("login",{username:t,password:n},function(t){t.success&&(localStorage.setItem("token",t.token),e((0,i["default"])(t.user)),a.browserHistory.push("/"))})}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(186),u=n(325),i=r(u)},361:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(163),a=n(362),u=r(a),i=n(365),s=r(i),l={signup:s["default"]};t["default"]=(0,o.connect)(null,l)(u["default"])},362:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),c=n(186),f=n(363),d=r(f),p=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={username:"",password:"",repeatPassword:""},n.synUsername=n.synUsername.bind(n),n.synPassword=n.synPassword.bind(n),n.synRepeatPassword=n.synRepeatPassword.bind(n),n.handleSignup=n.handleSignup.bind(n),n}return u(t,e),i(t,[{key:"synUsername",value:function(e){this.setState({username:e.target.value})}},{key:"synPassword",value:function(e){this.setState({password:e.target.value})}},{key:"synRepeatPassword",value:function(e){this.setState({repeatPassword:e.target.value})}},{key:"handleSignup",value:function(){var e=this.state,t=e.username,n=e.password;this.props.signup({username:t,password:n})}},{key:"render",value:function(){return l["default"].createElement("div",{className:d["default"].wrap},l["default"].createElement("input",{type:"text",className:d["default"].input,placeholder:"请输入用户名",onChange:this.synUsername,value:this.state.username}),l["default"].createElement("input",{type:"text",className:d["default"].input,placeholder:"请输入密码",onChange:this.synPassword,value:this.state.password}),l["default"].createElement("input",{type:"text",className:d["default"].input,placeholder:"请再次输入密码",onChange:this.synRepeatPassword,value:this.state.repeatPassword}),l["default"].createElement("input",{type:"button",className:d["default"].input+" "+d["default"].signup,value:"注册",onClick:this.handleSignup}),l["default"].createElement(c.Link,{className:"",to:"/login"},"已有账号？立即登录"))}}]),t}(s.Component);t["default"]=p,p.propTypes={signup:s.PropTypes.func.isRequired}},363:function(e,t){e.exports={wrap:"_15saa",input:"_3IfZ5",signup:"_2G1AR"}},365:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e.username,n=e.password;return function(e,r,o){o.emit("signup",{username:t,password:n},function(t){t.success&&(localStorage.setItem("token",t.token),e((0,i["default"])(t.user)),a.browserHistory.push("/"))})}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(186),u=n(325),i=r(u)}});